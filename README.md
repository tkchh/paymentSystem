# üè¶ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ Go: Production-Ready –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

![Go](https://img.shields.io/badge/Go-1.24-blue?logo=go)
![Docker](https://img.shields.io/badge/Docker-Ready-green?logo=docker)

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞–º–∏ —Å REST API, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ Go.
---

#### ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–Ø–∑—ã–∫**: Go 1.24
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏**:
  - `chi` (—Ä–æ—É—Ç–∏–Ω–≥)
  - `sqlite3` (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
  - `viper` (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
  - `slog` (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - `testify` (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (1 –º–∏–Ω—É—Ç–∞)

### 1. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
```bash
# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/tkchh/paymentSystem.git
cd paymentSystem

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker build -t payment-system .
docker run -p 8080:8080 --name payment-system payment-system
```

### 2. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/tkchh/paymentSystem.git
cd paymentSystem

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
go run ./cmd/paymentSystem/main.go
```


#### üåê API Endpoints
| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| `POST` | `/api/send` | –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –º–µ–∂–¥—É –∫–æ—à–µ–ª—å–∫–∞–º–∏ |
| `GET` | `/api/wallet/{address}/balance` | –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ |
| `GET` | `/api/transactions?count=N` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |

---

### –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

#### üìå –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
1. **HTTP API** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:
   - –ü–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É –∫–æ—à–µ–ª—å–∫–∞–º–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
2. **SQLite-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
3. **–°–ª–æ–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
   - Handlers (HTTP)
   - Services (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
   - Storage (—Ä–∞–±–æ—Ç–∞ —Å –ë–î)
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ YAML-—Ñ–∞–π–ª—ã
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ development/production
6. **–¢–µ—Å—Ç—ã** –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–µ–≤

---

#### üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏

**1. Handlers (HTTP)**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (`chi`)
- Middleware:
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
  - Recovery –æ—Ç –ø–∞–Ω–∏–∫
  - –¢–∞–π–º–∞—É—Ç—ã
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON-–æ—Ç–≤–µ—Ç–æ–≤
- **–¢–µ—Å—Ç—ã**: Mock-—Å–µ—Ä–≤–∏—Å—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–æ–≤ –æ—Ç–≤–µ—Ç–∞

**2. Services (–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)**
- –í–∞–ª–∏–¥–∞—Ü–∏—è:
  - –ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞
  - –ü–µ—Ä–µ–≤–æ–¥ —Å–∞–º–æ–º—É —Å–µ–±–µ
  - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –æ—à–∏–±–æ–∫ –≤ HTTP-—Å—Ç–∞—Ç—É—Å—ã
- **–¢–µ—Å—Ç—ã**: Mock-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**3. Storage (SQLite)**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞–º–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (10 –∫–æ—à–µ–ª—å–∫–æ–≤ –ø–æ 100 –µ–¥–∏–Ω–∏—Ü)
- **–¢–µ—Å—Ç—ã**: In-memory –±–∞–∑–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ ACID

---

#### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```yaml
# config.yaml
env: development #development/production
storage_path: "storage.db"

http_server:
  address: 0.0.0.0:8080
  timeout: 4s
  idle_timeout: 60s
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`CONFIG_PATH`, `PAYMENT_ENV`)
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ö–∞—Å–∫–∞–¥–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É (config.yaml ‚Üí config.example.yaml)

---

#### üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Development**: –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å debug-—É—Ä–æ–≤–Ω–µ–º
- **Production**: JSON-—Ñ–æ—Ä–º–∞—Ç —Å info-—É—Ä–æ–≤–Ω–µ–º
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
  - –°—Ç–∞—Ç—É—Å-–∫–æ–¥—ã
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —Å stack trace

---

#### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö:
   - –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
   - –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ—à–µ–ª—å–∫–∏
   - –ü–æ–ø—ã—Ç–∫–∏ —Å–∞–º–æ–ø–µ—Ä–µ–≤–æ–¥–∞
2. –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions:
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î 
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases:
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å
   - –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞
   - –¢–∞–π–º–∞—É—Ç—ã –ë–î

---

#### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –•—Ä–∞–Ω–∏–ª–∏—â–µ (—Ç–µ—Å—Ç—ã ACID-—Å–≤–æ–π—Å—Ç–≤)
- –°–µ—Ä–≤–∏—Å—ã (–±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞)
- –•–µ–Ω–¥–ª–µ—Ä—ã (HTTP-–æ—Ç–≤–µ—Ç—ã)

---

#### ‚ôªÔ∏è Graceful Shutdown
1. –ü–µ—Ä–µ—Ö–≤–∞—Ç SIGINT/SIGTERM
2. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:
   - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ HTTP-—Å–µ—Ä–≤–µ—Ä–∞ (15s —Ç–∞–π–º–∞—É—Ç)
   - –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
   - –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–æ–≤

---

#### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
1. **Foreign Keys** –≤ SQLite
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ context-—Ç–∞–π–º–∞—É—Ç–æ–≤
4. –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ (in-memory DB)

---

#### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
paymentSystem/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ paymentSystem/
‚îÇ       ‚îî‚îÄ‚îÄ main.go         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.example.yaml # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ handlers/           # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ logger/             # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ models/             # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ storage/            # –†–∞–±–æ—Ç–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
‚îÇ       ‚îî‚îÄ‚îÄ sqlite/         # SQLite —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ go.sum
‚îî‚îÄ‚îÄ Dockerfile              # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```
